{% extends 'layouts/base.html' %}

{% block title %} Dashboard {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}
<div class="container">
<h1>Add Property</h1>
   <div class="row">
    <div class="col-lg-12">
        <p>
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-success" id="flash-message">
                            <strong>{{ message }}</strong>
                        </div>
                        <script>
                            setTimeout(function() {
                                document.getElementById("flash-message").style.display = "none";
                            }, 2000);
                        </script>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </p>
    </div>
</div>



   <!-- Property upload form -->
   <form method="POST" action="/property-upload" enctype="multipart/form-data" >
    <div class="form-group">
                      <label>Choose Images: </label>
                      <input type="file" name="files[]" id="fileInput" class="form-control" multiple required>
                 </div>

                <div class="form-group">
                    <label for="name">Name:</label>
                    <input type="text" name="name" required><br>
                </div>
                 
                <div class="form-group"> 
                 <label for="price">Price:</label>
                 <input type="text" id="numberInput" name="price" oninput="formatNumber(this)">

                 <script>
                 function formatNumber(input) {
                     // Remove non-numeric characters
                     const cleanedValue = input.value.replace(/[^\d]/g, '');
                 
                     // Format the value with commas
                     const formattedValue = addCommas(cleanedValue);
                 
                     // Update the input field with the formatted value
                     input.value = formattedValue;
                 }
                 
                 function addCommas(value) {
                     return Number(value).toLocaleString();
                 }
                 </script>
                </div>

                <div class="form-group">
                 <label for="address">Address:</label>
                 <input type="text" name="address" required><br>
                </div>
                
                <div class="form-group">
                 <label for="status">Status:</label>
                 <select name="status" required>
                     <option value="For Sale">For Sale</option>
                     <option value="For Rent">For Rent</option>
                 </select><br>
                </div>
                
                <div class="form-group">
                 <label for="area">Area:</label>
                 <input type="number" name="area" required><br>
                </div>
                
                <div class="form-group">
                 <label for="bathroom">Bathroom:</label>
                 <input type="number" name="bathroom" required><br>
                </div>

                <div class="form-group">
                 <label for="garage">Garage:</label>
                 <input type="number" name="garage" required><br>
                </div>

                <div class="form-group">
                 <label for="property_type">Property Type:</label>
                 <input type="text" name="property_type" required><br>
                </div>
                 <input type="submit" name="submit" class="btn btn-success" value="UPLOAD"/>
             </form>
  </div>
  </div>
 </div>
</div>
<script>
$(document).ready(function(){
 // File type validation
    $("#fileInput").change(function(){
        var fileLength = this.files.length;
        var match= ["image/jpeg","image/png","image/jpg","image/gif"];
        var i;
        for(i = 0; i < fileLength; i++){ 
            var file = this.files[i];
            var imagefile = file.type;
            if(!((imagefile==match[0]) || (imagefile==match[1]) || (imagefile==match[2]) || (imagefile==match[3]))){
                alert('Please select a valid image file (JPEG/JPG/PNG/GIF).');
                $("#fileInput").val('');
                return false;
            }
        }
    });
});
</script>
</body>
{% include "includes/footer.html" %}

{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}

  <script src="static/admin/static/assets/vendor/chart.js/dist/Chart.min.js"></script>
  <script src="static/admin/static/assets/vendor/chart.js/dist/Chart.extension.js"></script>

{% endblock javascripts %}

